# 🚀 Hostingerデプロイフロー（完全版）

## 基本的な理解

### ❓ GitHubにプッシュするだけで自動デプロイされるの？

**答え**: 最初の設定をした後は、基本的に**はい**です。ただし、**最初に1回だけHostingerで設定する必要があります**。

## 📋 デプロイの流れ（ステップバイステップ）

### 初回設定（1回だけ必要）

#### ステップ1: GitHubにコードをプッシュ ✅
```bash
git add .
git commit -m "変更内容"
git push origin main
```
→ これはあなたが今やっていることです

#### ステップ2: Hostingerでアプリケーションを作成（初回のみ）
1. Hostingerにログイン
2. 「Node.jsアプリケーション」を作成
3. GitHubリポジトリと連携:
   - リポジトリURL: `https://github.com/SINJAPANLLC/sinjapan-logimatch-ver2.git`
   - ブランチ: `main`

#### ステップ3: Hostingerで設定を行う（初回のみ）

**3-1. 環境変数を設定**
```
DATABASE_URL=postgresql://...
JWT_SECRET=...
NEXTAUTH_URL=https://sinjapan-logimatch.com
PORT=5000
```

**3-2. ビルド設定**
- Build Command: `npm run build`
- Start Command: `npm start`
- Node.js Version: 20.x

**3-3. アプリケーションタイプを確認**
- ✅ Node.js が選択されているか確認（PHPではない）

#### ステップ4: 初回デプロイを実行
- Hostingerのダッシュボードから「デプロイ」ボタンをクリック

---

### 2回目以降（自動デプロイの場合）

**これ以降は簡単です！**

1. **コードを変更**
2. **GitHubにプッシュ**
   ```bash
   git add .
   git commit -m "変更内容"
   git push origin main
   ```
3. **Hostingerが自動的に検知してデプロイ**（設定で自動デプロイを有効にしている場合）

→ 以上！これだけです 🎉

---

## 🔄 2つのデプロイ方法

### 方法1: 自動デプロイ（推奨）

**設定**: Hostingerで「自動デプロイ」を有効にする

**流れ**:
```
コード変更 → GitHubにプッシュ → Hostingerが自動検知 → 自動デプロイ開始
```

**メリット**:
- プッシュするだけで自動的にデプロイされる
- 手動操作が不要

### 方法2: 手動デプロイ

**設定**: 自動デプロイを無効にする、または手動でデプロイボタンをクリック

**流れ**:
```
コード変更 → GitHubにプッシュ → Hostingerのダッシュボードで「デプロイ」ボタンをクリック
```

**メリット**:
- デプロイのタイミングを自分でコントロールできる
- テストしてからデプロイしたい場合に便利

---

## 📝 まとめ

### 初回だけ（1回）
1. ✅ GitHubにコードをプッシュ（完了）
2. ⚠️ Hostingerでアプリケーションを作成
3. ⚠️ Hostingerで環境変数とビルド設定を行う
4. ⚠️ 初回デプロイを実行

### 2回目以降
1. ✅ コードを変更
2. ✅ GitHubにプッシュ
3. ✅ 自動デプロイ（または手動でデプロイボタンをクリック）

---

## ⚠️ 重要な注意点

### 現在の問題

あなたのデプロイログを見ると：
```
Looking for composer.lock file
Looking for composer.json file
```

これは、Hostingerが**PHPアプリケーション**として認識していることを示しています。

### 解決方法

**Hostingerのダッシュボードで以下を確認してください**:

1. アプリケーション設定を開く
2. 「アプリケーションタイプ」または「Runtime」を確認
3. **「Node.js」が選択されているか確認**
4. PHPになっている場合は、**「Node.js」に変更して保存**
5. 再度デプロイを実行

### 正しいデプロイログ

Node.jsとして正しく認識されている場合、以下のようなログが表示されます：
```
Looking for package.json file
package.json file was found
Running npm install
Running npm run build
Running npm start
```

---

## 🎯 今やるべきこと

1. **Hostingerのダッシュボードを開く**
2. **アプリケーション設定を確認**
   - アプリケーションタイプが「Node.js」になっているか
   - 環境変数が設定されているか
   - ビルドコマンドとスタートコマンドが設定されているか
3. **設定を修正（必要に応じて）**
4. **再度デプロイを実行**

---

## 💡 よくある質問

### Q: GitHubにプッシュすれば自動的にデプロイされるの？
A: 初回設定を完了していれば、自動デプロイが有効な場合は自動的にデプロイされます。

### Q: 毎回手動でデプロイボタンを押す必要があるの？
A: 自動デプロイを有効にしていれば不要です。手動でデプロイしたい場合は、その都度ボタンを押してください。

### Q: デプロイに時間はどのくらいかかるの？
A: 通常5〜10分程度です。ビルドのサイズによって異なります。

### Q: デプロイが失敗したらどうすればいいの？
A: Hostingerのログビューアーでエラーメッセージを確認してください。よくある原因：
- 環境変数が設定されていない
- ビルドエラー
- 依存関係のエラー

